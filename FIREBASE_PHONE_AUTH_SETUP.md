# ุฅุนุฏุงุฏ ุงูุชุญูู ูู ุงููุงุชู ุนุจุฑ Firebase ููุชุณุฌูู (Phone Authentication)

ุชู ุชูููุฐ ุฎุงุตูุฉ ุงูุชุญูู ูู ุฑูู ุงููุงุชู ุนุจุฑ ุฑุณุงุฆู SMS ูู ุนูููุฉ ุงูุชุณุฌูู (Register) ุจุงุณุชุฎุฏุงู Firebase Authentication.

## ๐ ุงููููุงุช ุงููุถุงูุฉ/ุงููุนุฏูุฉ

### 1. ูููุงุช ุฌุฏูุฏุฉ
- **`lib/features/auth/presentation/pages/otp_verification_page.dart`**
  - ุดุงุดุฉ ุฅุฏุฎุงู ุฑูุฒ ุงูุชุญูู (OTP) ุงููููู ูู 6 ุฃุฑูุงู
  - ุชุฏุนู ุฅุนุงุฏุฉ ุฅุฑุณุงู ุงูุฑูุฒ ุจุนุฏ 60 ุซุงููุฉ
  - ูุงุฌูุฉ ูุณุชุฎุฏู ุฌูููุฉ ูุณููุฉ ุงูุงุณุชุฎุฏุงู

### 2. ูููุงุช ูุนุฏูุฉ
- **`lib/features/auth/presentation/pages/register_page.dart`**
  - ุฅุถุงูุฉ ุฎุทูุฉ ุงูุชุญูู ูู OTP ุจุนุฏ ุฅุฏุฎุงู ุฑูู ุงููุงุชู
  - ุฅุฑุณุงู OTP ุชููุงุฆูุงู ุนูุฏ ุงูุงูุชูุงู ูู ุงูุฎุทูุฉ ุงูุฃููู
  - ุงูุชุญูู ูู OTP ูุจู ุงูุงูุชูุงู ูุฅููุงู ุจูุงูุงุช ุงูุชุณุฌูู

- **`lib/core/providers/auth_provider.dart`**
  - ุชุนุฏูู ุฏุงูุฉ `register()` ููุชุญูู ูู OTP ูุจู ุฅูุดุงุก ุงูุญุณุงุจ
  - ุฑุจุท ุฑูู ุงููุงุชู ุจุงูุญุณุงุจ ุจุนุฏ ุฅูุดุงุฆู
  - ุงูุฏูุงู ุงูููุฌูุฏุฉ ูุณุจูุงู:
    - `sendRegistrationOtp()`: ุฅุฑุณุงู ุฑูุฒ OTP
    - `verifyRegistrationOtp()`: ุงูุชุญูู ูู ุฑูุฒ OTP
    - `resetRegistrationOtpState()`: ุฅุนุงุฏุฉ ุชุนููู ุญุงูุฉ OTP

- **`lib/core/router/app_router.dart`**
  - ุฅุถุงูุฉ route ุฌุฏูุฏ `/otp-verification` ูุดุงุดุฉ ุงูุชุญูู
  - ุฅุถุงูุฉ ุงูู route ููุตูุญุงุช ุงูุนุงูุฉ (public routes)

- **`lib/features/common/presentation/pages/profile_page.dart`**
  - ุฅุตูุงุญ ุฃุฎุทุงุก ูู ุงูููุฏ (ุชู ุณุงุจูุงู)

## ๐ง ุฎุทูุงุช ุฅุนุฏุงุฏ Firebase Console

### 1. ุชูุนูู Phone Authentication

1. ุงูุชุญ Firebase Console: https://console.firebase.google.com
2. ุงุฎุชุฑ ูุดุฑูุน **`firebase-networkapp`**
3. ุงูุชูู ุฅูู **Authentication** โ **Sign-in method**
4. ูุนูู **Phone** ูู ูุงุฆูุฉ ูููุฑู ุงูุฎุฏูุฉ (Providers)
5. ุงุญูุธ ุงูุชุบููุฑุงุช

### 2. ุฅุนุฏุงุฏ SHA-1 ููู Android (ููู ุฌุฏุงู)

ููู ุชุนูู ุฎุงุตูุฉ Phone Authentication ุนูู Androidุ ูุฌุจ ุฅุถุงูุฉ ุจุตูุฉ SHA-1:

#### ุงูุญุตูู ุนูู SHA-1

**ุนูู Windows:**
```powershell
cd android
.\gradlew signingReport
```

**ุนูู Mac/Linux:**
```bash
cd android
./gradlew signingReport
```

ุณุชุฌุฏ SHA-1 ุชุญุช ูุณู `Task :app:signingReport`:
```
Variant: debug
Config: debug
Store: C:\Users\YourName\.android\debug.keystore
Alias: AndroidDebugKey
MD5: XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX
SHA1: XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX
SHA-256: ...
Valid until: ...
```

#### ุฅุถุงูุฉ SHA-1 ุฅูู Firebase

1. ูู Firebase Consoleุ ุงูุชูู ุฅูู **Project Settings** (ุงูุฅุนุฏุงุฏุงุช)
2. ุงุฎุชุฑ ุชุทุจูู Android ุงูุฎุงุต ุจู
3. ุงูุฒู ููุฃุณูู ุญุชู ูุณู **SHA certificate fingerprints**
4. ุงุถุบุท **Add fingerprint**
5. ุงูุตู SHA-1 ุงูุฐู ุญุตูุช ุนููู
6. ุงุญูุธ ูุงุถุบุท **Download google-services.json**
7. ุงุณุชุจุฏู ุงูููู ูู `android/app/google-services.json`

### 3. ุชูุนูู ุงูู Test Phone Numbers (ููุชุทููุฑ)

ุฃุซูุงุก ุงูุชุทููุฑุ ููููู ุฅุถุงูุฉ ุฃุฑูุงู ููุงุชู ููููุฉ ููุงุฎุชุจุงุฑ:

1. ูู Firebase Console โ **Authentication** โ **Sign-in method**
2. ุงูุฒู ูุฃุณูู ุฅูู **Phone numbers for testing**
3. ุฃุถู ุฃุฑูุงู ููููุฉ ูุน ุฃููุงุฏ ุงูุชุญูู ุงููุฎุตุตุฉุ ูุซู:
   - Phone: `+967777777777`
   - Code: `123456`

## ๐ฑ ููููุฉ ุนูู ุงูุชุฏูู (Flow)

### 1. ุงููุณุชุฎุฏู ููุชุญ ุดุงุดุฉ ุงูุชุณุฌูู
- ูุฎุชุงุฑ ููุน ุงูุญุณุงุจ (ูุงูู ุดุจูุฉ / ููุทุฉ ุจูุน)
- ูุฏุฎู ุฑูู ุงููุงุชู
- ูุฏุฎู ูููุฉ ุงููุฑูุฑ ูุชุฃููุฏูุง

### 2. ุฅุฑุณุงู OTP
- ุนูุฏ ุงูุถุบุท ุนูู "ุงูุชุงูู"ุ ูุชู ุงุณุชุฏุนุงุก:
  ```dart
  authProvider.sendRegistrationOtp(phone)
  ```
- Firebase ูุฑุณู ุฑุณุงูุฉ SMS ุชุญุชูู ุนูู ุฑูุฒ ูููู ูู 6 ุฃุฑูุงู

### 3. ุดุงุดุฉ ุงูุชุญูู ูู OTP
- ุงููุณุชุฎุฏู ููุชูู ุฅูู `OtpVerificationPage`
- ูุฏุฎู ุงูุฑูุฒ ุงููููู ูู 6 ุฃุฑูุงู
- ูููู ุฅุนุงุฏุฉ ุฅุฑุณุงู ุงูุฑูุฒ ุจุนุฏ 60 ุซุงููุฉ

### 4. ุงูุชุญูู ูู OTP
- ุนูุฏ ุฅุฏุฎุงู ุงูุฑูุฒุ ูุชู ุงุณุชุฏุนุงุก:
  ```dart
  authProvider.verifyRegistrationOtp(phone, otpCode)
  ```
- ุฅุฐุง ูุงู ุงูุฑูุฒ ุตุญูุญุงูุ ูุชู ุญูุธ `PhoneAuthCredential`

### 5. ุฅููุงู ุงูุชุณุฌูู
- ุงููุณุชุฎุฏู ููุชูู ูุฅููุงู ุจูุงูุงุช ุงูุญุณุงุจ
- ุนูุฏ ุงูุถุบุท ุนูู "ุฅููุงุก ุงูุชุณุฌูู"ุ ูุชู:
  1. ุฅูุดุงุก ุญุณุงุจ ุจุงุณุชุฎุฏุงู Email/Password
  2. ุฑุจุท ุฑูู ุงููุงุชู ุจุงูุญุณุงุจ ุจุงุณุชุฎุฏุงู `PhoneAuthCredential`
  3. ุญูุธ ุจูุงูุงุช ุงููุณุชุฎุฏู ูู Firestore

## ๐ ุงูุฃูุงู

### ูู ูุถุน Production
- ุงูุชุญูู ูู OTP **ูุทููุจ** ููุง ูููู ุชุฎุทูู
- ุงูููุฏ:
  ```dart
  if (!kDebugMode && !_registrationOtpVerified) {
    throw Exception('ูุฌุจ ุงูุชุญูู ูู ุฑูู ุงููุงุชู ุฃููุงู');
  }
  ```

### ูู ูุถุน Debug/Development
- ูููู ุชุฎุทู ุงูุชุญูู ูู OTP ููุงุฎุชุจุงุฑ ุงูุณุฑูุน
- ุงูููุฏ:
  ```dart
  if (kDebugMode) {
    return bypassRegistrationOtpForTesting(phone);
  }
  ```

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงูุงุฎุชุจุงุฑ ูู Debug Mode
1. ุดุบูู ุงูุชุทุจูู ูู ูุถุน Debug
2. ุณุฌูู ุจุงุณุชุฎุฏุงู ุฃู ุฑูู ูุงุชู
3. ุณูุชู ุชุฎุทู ุงูุชุญูู ูู OTP ุชููุงุฆูุงู

### ุงูุงุฎุชุจุงุฑ ูุน Test Phone Numbers
1. ุฃุถู ุฑูู ูุงุชู ูููู ูู Firebase Console
2. ุงุณุชุฎุฏู ุงูุฑูู ุงููููู ูู ุงูุชุณุฌูู
3. ุฃุฏุฎู ุงูุฑูุฒ ุงููุฎุตุต ุงูุฐู ุญุฏุฏุชู

### ุงูุงุฎุชุจุงุฑ ูู Production
1. ุงุณุชุฎุฏู ุฑูู ูุงุชู ุญูููู ูููู (+967...)
2. ุณุชุตูู ุฑุณุงูุฉ SMS ูุนููุฉ ูู Firebase
3. ุฃุฏุฎู ุงูุฑูุฒ ุงูููุฌูุฏ ูู ุงูุฑุณุงูุฉ

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. ุชูุณูู ุฑูู ุงููุงุชู
- ุงูุชุทุจูู ูุฏุนู ุงูุฃุฑูุงู ุงูููููุฉ ููุท
- ุงูุชูุณูู ุงููุชููุน: `777123456` (9 ุฃุฑูุงู)
- ูุชู ุชุญูููู ุชููุงุฆูุงู ุฅูู: `+967777123456`

### 2. ุญุฏูุฏ Firebase
- Firebase ูุฏูู ุญุฏูุฏ ูุฌุงููุฉ ูุฅุฑุณุงู SMS
- **Spark Plan (ูุฌุงูู):** ูุง ูุฏุนู Phone Authentication
- **Blaze Plan (ุงูุฏูุน ุญุณุจ ุงูุงุณุชุฎุฏุงู):** ูุทููุจ ูุชูุนูู Phone Auth
- ุงูุฃุณุนุงุฑ: https://firebase.google.com/pricing#authentication

### 3. ุงูุชูููุฉ
- ูู ุฑุณุงูุฉ SMS ููุง ุชูููุฉ ุญุณุจ ุงูุฏููุฉ
- ุชูููุฉ SMS ููููู ุชุชุฑุงูุญ ุจูู $0.02 - $0.05 ููุฑุณุงูุฉ
- ูููู ูุฑุงุฌุนุฉ ุงูุชูุงููู ูู: https://cloud.google.com/identity-platform/pricing

### 4. ุงูุจูุฆุฉ ุงููุญููุฉ (Local Testing)
- ูุง ูููู ุงุฎุชุจุงุฑ Phone Auth ุจุดูู ูุงูู ุนูู ุงููุญุงูู
- ูููุถู ุงูุงุฎุชุจุงุฑ ุนูู ุฌูุงุฒ ูุนูู
- ุฃู ุงุณุชุฎุฏุงู Test Phone Numbers

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ูุจู ุงูุฅุทูุงู (Production)
1. โ ุชูุนูู Phone Authentication ูู Firebase
2. โ ุฅุถุงูุฉ SHA-1 fingerprints
3. โ ุชุฑููุฉ ูุดุฑูุน Firebase ุฅูู Blaze Plan
4. โ๏ธ ุชูุนูู App Check (ูุนุทู ุญุงููุงู)
5. โ๏ธ ุฅุถุงูุฉ ุญูุงูุฉ ุถุฏ ุงูุฑูุจูุชุงุช (reCAPTCHA)
6. โ๏ธ ูุฑุงูุจุฉ ุงูุงุณุชุฎุฏุงู ูุงูุชูุงููู

### ูููุทูุฑูู
- ุฑุงุฌุน ููู `BEFORE_PRODUCTION_CHECKLIST.md` ูููุฒูุฏ ูู ุงูุชูุงุตูู
- ุชุฃูุฏ ูู ุงุฎุชุจุงุฑ ุงูุชุฏูู ุงููุงูู ูุจู ุงููุดุฑ

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุฃูุฏ ูู ุฅุถุงูุฉ SHA-1 ุจุดูู ุตุญูุญ
2. ุชุฃูุฏ ูู ุชูุนูู Phone Authentication ูู Firebase
3. ุชุฃูุฏ ูู ุฃู ุงููุดุฑูุน ุนูู Blaze Plan
4. ุฑุงุฌุน ุงูู logs ูู Firebase Console โ Authentication โ Usage

---

ุชู ุงูุชูููุฐ ุจูุงุณุทุฉ: AI Assistant
ุงูุชุงุฑูุฎ: 2025-11-02
ุงููุดุฑูุน: network_app

