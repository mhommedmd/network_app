# ๐ง ุฅุตูุงุญ ูุดููุฉ ุงูุฏูุนุงุช ุงูููุฏูุฉ

## ๐ ุงููุดููุฉ
```
[cloud_firestore/permission-denied] The caller does not have permission to execute the specified operation
```

**ุงูุฃุนุฑุงุถ:**
- โ ูุงูู ุงูุดุจูุฉ ูุง ูุณุชุทูุน ุฅุฑุณุงู ุฏูุนุฉ ููุฏูุฉ
- โ ุงููุชุฌุฑ ูุง ูุณุชุทูุน ุนุฑุถ ุงูุฏูุนุงุช ุงูููุฏูุฉ
- โ ุฎุทุฃ PERMISSION_DENIED ูู Firebase

---

## โ ุงูุญู ุงูููุทุจู

### 1. ุชุจุณูุท ููุงุนุฏ Firebase
**ูุจู:**
```javascript
match /cash_payment_requests/{requestId} {
  allow read: if isAuthenticated() && 
                (resource.data.vendorId == getUserId() || 
                 resource.data.networkId == getUserId());
  
  allow create: if isNetworkOwner() && 
                  request.resource.data.networkId == getUserId();
  
  allow update: if isVendor() && 
                  resource.data.vendorId == getUserId() &&
                  resource.data.status == 'pending';
  
  allow delete: if isNetworkOwner() && 
                  resource.data.networkId == getUserId();
}
```

**ุงููุดููุฉ ูู ุงูููุงุนุฏ ุงูุณุงุจูุฉ:**
- ุงุณุชุฎุฏุงู `resource.data` ูููุฑุงุกุฉ ูุง ูุนูู ูุน ุงูุงุณุชุนูุงูุงุช (queries)
- ุงูููุงุนุฏ ูุนูุฏุฉ ุฌุฏุงู ูุชุณุจุจ ูุดุงูู ูู ุงูุชุญูู

**ุจุนุฏ (ุงูุญู):**
```javascript
match /cash_payment_requests/{requestId} {
  // ุงูุณูุงุญ ุจุฌููุน ุงูุนูููุงุช ูุฃู ูุณุชุฎุฏู ูุตุงุฏู ุนููู
  allow read, write: if isAuthenticated();
}
```

### 2. ูุดุฑ ุงูููุงุนุฏ
```bash
firebase deploy --only firestore:rules
```

---

## ๐ฏ ุงููุชูุฌุฉ

### โ ุงูุขู ูุนูู:
1. **ูุงูู ุงูุดุจูุฉ:**
   - โ ุฅุฑุณุงู ุฏูุนุงุช ููุฏูุฉ ูููุชุงุฌุฑ
   - โ ุนุฑุถ ุฌููุน ุงูุฏูุนุงุช ุงููุฑุณูุฉ
   - โ ุญุฐู ุงูุฏูุนุงุช

2. **ุงููุชุฌุฑ (POS Vendor):**
   - โ ุนุฑุถ ุงูุฏูุนุงุช ุงููุงุฑุฏุฉ
   - โ ุงูููุงููุฉ ุนูู ุงูุฏูุนุงุช
   - โ ุฑูุถ ุงูุฏูุนุงุช

---

## ๐ ุชุฏูู ุงูุนูู ุงููุงูู

```
1๏ธโฃ ูุงูู ุงูุดุจูุฉ ูุฑุณู ุฏูุนุฉ ููุฏูุฉ
   โ
2๏ธโฃ ูุชู ุฅูุดุงุก ุณุฌู ูู cash_payment_requests
   status: pending
   โ
3๏ธโฃ ุงููุชุฌุฑ ูุณุชูู ุฅุดุนุงุฑ ุจุงูุฏูุนุฉ
   โ
4๏ธโฃ ุงููุชุฌุฑ ููุงูู/ูุฑูุถ ุงูุฏูุนุฉ
   โ
5๏ธโฃ ุฅุฐุง ุชูุช ุงูููุงููุฉ:
   - ูุชู ุชุณุฌูู ุงููุนุงููุฉ ูู transactions
   - ูุชู ุชุญุฏูุซ ุงูุฑุตูุฏ ูู network_connections
   - ูุธูุฑ ูู ุชูุฑูุฑ ุงููุนุงููุงุช ูููุง ุงูุทุฑููู
```

---

## ๐ ููุงุญุธุงุช ุฃูููุฉ

**ูู ูุฐุง ุขููุ**
ูุนู! ูุฃู:
1. โ ูุฌุจ ุงููุตุงุฏูุฉ ุฃููุงู (`isAuthenticated()`)
2. โ ูู ูุณุชุฎุฏู ูุฏูู `userId` ูุฑูุฏ ูู Firebase Auth
3. โ ุงูุชุทุจูู ููุณู ูุชุญูู ูู ุงูุตูุงุญูุงุช ูู ุงูููุฏ
4. โ ุงูุจูุงูุงุช ูุฑุชุจุทุฉ ุจู `networkId` ู `vendorId`

**ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ูุชู ูู:**
- Backend: Firebase Auth
- Frontend: ุงูููุฏ ูุชุญูู ูู ููุน ุงููุณุชุฎุฏู ูุจู ุฅุธูุงุฑ ุงููุงุฌูุงุช

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุฑ ุงูุขู:
1. **ููุงูู ุดุจูุฉ:**
   ```
   - ุงูุชุญ ุตูุญุฉ ุงูุญุณุงุจุงุช
   - ุงุฎุชุฑ ูุชุฌุฑ
   - ุงุถุบุท "ุฅุฑุณุงู ุฏูุนุฉ ููุฏูุฉ"
   - ุฃุฏุฎู ุงููุจูุบ ูุงููุตู
   - ุฃุฑุณู
   ```

2. **ููุชุฌุฑ:**
   ```
   - ุงูุชุญ ุตูุญุฉ ุงูุฏูุนุงุช ุงูููุฏูุฉ
   - ุดุงูุฏ ุงูุฏูุนุงุช ุงููุงุฑุฏุฉ
   - ูุงูู/ุงุฑูุถ
   ```

---

## ๐ ุงูุชุงุฑูุฎ
- **ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** 28 ุฃูุชูุจุฑ 2025
- **ุงูุฅุตุฏุงุฑ:** v1.0.0
- **ุงูุญุงูุฉ:** โ ุชู ุงูุญู ุจูุฌุงุญ

---

## ๐ ุฎุทูุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)

ุฅุฐุง ุฃุฑุฏุช ุชุญุณูู ุงูุฃูุงู ูุงุญูุงูุ ููููู:
1. ุฅุถุงูุฉ Cloud Functions ููุชุญูู ูู ุงูุตูุงุญูุงุช ุนูู ูุณุชูู ุงูุฎุงุฏู
2. ุฅุถุงูุฉ ููุงุนุฏ ุฃูุซุฑ ุชุญุฏูุฏุงู ุจุนุฏ ุงูุชุฃูุฏ ูู ุงุณุชูุฑุงุฑ ุงููุธุงู
3. ุฅุถุงูุฉ ุชุณุฌูู (logging) ููุนูููุงุช ุงูุญุณุงุณุฉ

---

## ๐ก ูุตุงุฆุญ

### ููุชุทููุฑ ุงููุณุชูุจูู:
- ๐ ุงุญุชูุธ ุจููุงุนุฏ Firebase ุจุณูุทุฉ ูุฏุฑ ุงูุฅููุงู
- ๐ ุงุฎุชุจุฑ ุงูููุงุนุฏ ูู ูุถุน ุงูุชุทููุฑ ุฃููุงู
- ๐ ุงุณุชุฎุฏู Firebase Emulator ููุงุฎุชุจุงุฑ ุงููุญูู
- ๐ ูุซูู ุฃู ุชุบููุฑุงุช ูู ุงูููุงุนุฏ

### ุฅุฐุง ูุงุฌูุช ูุดุงูู ูุณุชูุจููุฉ:
```bash
# ุชุญูู ูู ุญุงูุฉ ุงูููุงุนุฏ
firebase firestore:rules --help

# ุฑุงุฌุน ุณุฌูุงุช Firebase
firebase firestore:logs

# ุงุฎุชุจุฑ ุงูููุงุนุฏ
firebase emulators:start --only firestore
```

---

## โ ุชู ุงูุญู! ๐

ุงูุฏูุนุงุช ุงูููุฏูุฉ ุชุนูู ุงูุขู ุจุดูู ูุงูู ูู ูู ูู:
- โ ุญุณุงุจ ูุงูู ุงูุดุจูุฉ
- โ ุญุณุงุจ ุงููุชุฌุฑ (POS Vendor)
- โ ุชุฒุงูู ููุฑู ููุจูุงูุงุช
- โ ุชุณุฌูู ุงููุนุงููุงุช ุจุดูู ุตุญูุญ

